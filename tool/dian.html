<!doctype html>
<html>
<head>
	<meta charset="utf-8" />
	<title>合租电费分摊计算器 - 上海</title>
	<style type="text/css">
	.warpper{width:500px;margin:0 auto;padding:15px 0;}
	.table-list th{text-align:right;}
	.foot{text-align:right;padding:10px;}
	</style>
</head>
<body>
<div class="warpper">
	<h1>合租电费分摊计算器 - 上海</h1>
	<p>使用此电费分摊计算器的条件是：假设分电表的峰(谷)值和总表的峰(谷)值比例是一样的。</p>
	<table class="table-list">
		<tbody>
			<tr>
				<th>峰值(电量):</th><td><input type="text" id="du_1_1" value="0" /></td>
				<th>单价:</th><td><input type="text" id="price_du_1_1" value="0.617" /></td>
			</tr>
			<tr>
				<th>谷值(电量):</th><td><input type="text" id="du_1_2" value="0" /></td>
				<th>单价:</th><td><input type="text" id="price_du_1_2" value="0.307" /></td>
			</tr>
			<tr>
				<th>峰值(二档):</th><td><input type="text" id="du_2_1" value="0" /></td>
				<th>单价:</th><td><input type="text" id="price_du_2_1" value="0.06" /></td>
			</tr>
			<tr>
				<th>谷值(二档):</th><td><input type="text" id="du_2_2" value="0" /></td>
				<th>单价:</th><td><input type="text" id="price_du_2_2" value="0.03" /></td>
			</tr>
			<tr>
				<th>峰值(三档):</th><td><input type="text" id="du_3_1" value="0" /></td>
				<th>单价:</th><td><input type="text" id="price_du_3_1" value="0.36" /></td>
			</tr>
			<tr>
				<th>谷值(三档):</th><td><input type="text" id="du_3_2" value="0" /></td>
				<th>单价:</th><td><input type="text" id="price_du_3_2" value="0.18" /></td>
			</tr>
			<tr>
				<th>分表用电量:</th><td colspan="3"><input type="text" id="xxx_du" value="0" /></td>
			</tr>
			<tr>
				<th>峰值(电量):</th><td id="xxx_du_1_1">&yen;0.617 x 0</td>
				<th>小计:</th><td id="xxx_price_du_1_1">&yen;0</td>
			</tr>
			<tr>
				<th>谷值(电量):</th><td id="xxx_du_1_2">&yen;0.307 x 0</td>
				<th>小计:</th><td id="xxx_price_du_1_2">&yen;0</td>
			</tr>
			<tr>
				<th>峰值(二档):</th><td id="xxx_du_2_1">&yen;0.060 x 0</td>
				<th>小计:</th><td id="xxx_price_du_2_1">&yen;0</td>
			</tr>
			<tr>
				<th>谷值(二档):</th><td id="xxx_du_2_2">&yen;0.030 x 0</td>
				<th>小计:</th><td id="xxx_price_du_2_2">&yen;0</td>
			</tr>
			<tr>
				<th>峰值(三档):</th><td id="xxx_du_3_1">&yen;0.360 x 0</td>
				<th>小计:</th><td id="xxx_price_du_3_1">&yen;0</td>
			</tr>
			<tr>
				<th>谷值(三档):</th><td id="xxx_du_3_2">&yen;0.180 x 0</td>
				<th>小计:</th><td id="xxx_price_du_3_2">&yen;0</td>
			</tr>
			<tr>
				<th>分表总费用:</th><td colspan="3" id="xxx_du_sum">&yen;0</td>
			</tr>
		</tbody>
	</table>
	<div class="foot">
		<button id="sum_price">计算分表用电量及总价</button>
	</div>
</div>
<script type="text/javascript">
(function(){
	var cache_price = {};
	var cache_amount = {};
	var g = function(id){
		return document.getElementById(id);
	};
	g.getFloat = function(id){
		var p = g(id).value;
		return parseFloat(p) || 0;
	};
	g.getAmount = function(id){
		cache_amount[id] = this.getFloat(id);
	};
	g.getUnitPrice = function(id){
		cache_price[id] = this.getFloat(id);
	};
	g.initOptions = function(){
		g.getUnitPrice('price_du_1_1');
		g.getUnitPrice('price_du_1_2');
		g.getUnitPrice('price_du_2_1');
		g.getUnitPrice('price_du_2_2');
		g.getUnitPrice('price_du_3_1');
		g.getUnitPrice('price_du_3_2');
		g.getAmount('du_1_1');
		g.getAmount('du_1_2');
		g.getAmount('du_2_1');
		g.getAmount('du_2_2');
		g.getAmount('du_3_1');
		g.getAmount('du_3_2');
		g.getAmount('xxx_du');
	};
	g.setResult = function(key, xxx_value){
		var price = xxx_value * cache_price['price_' + key];
		g('xxx_' + key).innerHTML = '&yen;' + cache_price['price_' + key].toFixed(3) + ' x ' + xxx_value.toFixed(3);
		g('xxx_price_' + key).innerHTML = '&yen;' + price.toFixed(3);
		return price;
	};
	g.sum = function(){
		var all = cache_amount.du_1_1 + cache_amount.du_1_2;
		var xxx_du = cache_amount.xxx_du;
		var xxx_du_1_1 = cache_amount.du_1_1 > 0 ? cache_amount.du_1_1 / all * xxx_du : 0;
		var xxx_du_1_2 = cache_amount.du_1_2 > 0 ? cache_amount.du_1_2 / all * xxx_du : 0;
		var xxx_du_2_1 = cache_amount.du_2_1 > 0 ? cache_amount.du_2_1 / all * xxx_du : 0;
		var xxx_du_2_2 = cache_amount.du_2_2 > 0 ? cache_amount.du_2_2 / all * xxx_du : 0;
		var xxx_du_3_1 = cache_amount.du_3_1 > 0 ? cache_amount.du_3_1 / all * xxx_du : 0;
		var xxx_du_3_2 = cache_amount.du_3_2 > 0 ? cache_amount.du_3_2 / all * xxx_du : 0;
		var sum = g.setResult('du_1_1', xxx_du_1_1);
		sum = sum + g.setResult('du_1_2', xxx_du_1_2);
		sum = sum + g.setResult('du_2_1', xxx_du_2_1);
		sum = sum + g.setResult('du_2_2', xxx_du_2_2);
		sum = sum + g.setResult('du_3_1', xxx_du_3_1);
		sum = sum + g.setResult('du_3_2', xxx_du_3_2);
		g('xxx_du_sum').innerHTML = '&yen;' + sum.toFixed(3);
	};
	g.init = function(){
		g('sum_price').onclick = function(){
			g.initOptions();
			g.sum();
		};
	};
	g.init();
}());
</script>
</body>
</html>