<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Read Word</title>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" >
    <meta name="renderer" content="webkit">
    <style type="text/css">
      html { font-size: 24px; }
      body { text-align: center; font-size: 1rem; }
      #words, #input { flex: 1; min-height: 520px; }
      #words { border: 1px solid #ccc; background-color: #efefef; text-align: left; word-break: break-word; font-size: 1rem; }
      #words li { list-style: decimal-leading-zero; padding-left: 0.3rem; }
      #words a { display: inline-flex; padding: 0.3rem; cursor: pointer; white-space: nowrap; }
      #words a[selected] { color: red; }
      #words a:hover { color: red; }
      #input { font-size: 1rem; line-height: 1.5; }
      #btn { padding: 0 1rem; }
      #select { margin-left: 2rem; font-size: 1rem; }
      .wrapper { display:flex; max-width: 960px; margin: 1rem auto; }
      .audio { display: flex; justify-content: center; margin-top: 1rem; }
      .audio input { width: 6rem; margin: 0 1rem; text-align:center; }
    </style>
</head>
<body>
<div>
  <input id="type0" name="type" type="radio" value="0" /><label for="type0">美式</label>
  <input id="type1" name="type" type="radio" value="1" checked="checked" /><label for="type1">英式</label>
  <select id="select"></select>
</div>
<div class="audio">
  <audio id="audio" controls="controls"></audio>
  <input type="number" value="3" id="count" />
  <input type="number" value="3" id="delay" />
  <button id="btn">开始</button>
</div>
<div class="wrapper">
  <textarea id="input"></textarea>
  <div id="words"></div>
</div>
<script>
const word_list_data = [
"2025-7-1 morning|早晨 minute|分钟 afternoon|下午 evening|晚上 night|夜晚",
"2025-7-2 today|今天 tomorrow|明天 ago|以前 day|天 last|最后 now|现在 then|当时 always|一直 often|经常 sometimes|有时",
"2025-7-3 half|一半 pair|一双 much|许多(不可数) many|许多(可数) too|也 little|小的 big|大的 lot|非常 heavy|重的 never|绝不",
"2025-7-4 keep|保存 come|来 go|去 get|得到 begin|开始 top|上面 over|在...上 long|长的 far|远的 near|附近",
"2025-7-5 color|颜色 black|黑色 there|在那 here|在这 pink|粉色 brown|棕色 white|白色 yellow|黄色 red|红色 green|绿色",
"2025-7-7 umbrella|伞 under|在...下 chair|椅子 blue|蓝色 box|盒子 doll|玩偶 clock|钟 behind|在...后 toy|玩具 between|在...中间",
"2025-7-8 housework|家务 father|父亲 mother|母亲 parent|父母 grandfather|祖父 grandmother|祖母 sister|姐妹 brother|兄弟 left|左 south|南",
"2025-7-9 baby|婴儿 kid|年轻人 down|下 home|家 call|通话 boy|男孩 child|儿童 back|后面 girl|女孩 hometown|家乡",
"2025-7-10 face|脸 mouth|嘴 arm|手臂 foot|脚 leg|腿 head|头 ear|耳 nose|鼻 hand|手 hair|头发",
"2025-7-11 egg|鸡蛋 bread|面包 milk|牛奶 by|在...旁 family|家庭 chicken|鸡肉 ice$cream|冰激凌 juice|果汁 tea|茶 out|出来",
"2025-7-12 meet|遇到 sit|坐 live|生活 name|名字 young|年轻的 middle|中等 chore|日常事务 birthday|生日 tall|高的 strong|强壮的",
"2025-7-14 beautiful|美丽的 cute|可爱的 lovely|美好的 nice|令人愉快的 great|卓越 kind|善良的 share|分享 hello|你好 fine|好看的 goodbye|再见 friend|朋友 people|人们",
"2025-7-15 angry|生气的 behave|表现 feel|感到 Mr|先生 Mrs|夫人 careful|小心的 quiet|安静的 contribute|捐献 help|帮助 helpful|有帮助的",
"2025-7-16 excited|激动的 interesting|有趣的 best|最好的 music|音乐 sing|唱 ball|球 baseball|棒球 football|足球 swim|游泳 lose|输",
"2025-7-17 moon|月球 idea|主意 sure|肯定 open|打开 happy|快乐的 job|工作 sad|悲伤的 food|食物 worry|发愁 tired|疲劳的",
"2025-7-18 fruit|水果 apple|苹果 banana|香蕉 grape|葡萄 meat|肉类 cake|蛋糕 candy|糖果 wall|墙 window|窗户 supermarket|超市",
"2025-7-22 cup|杯子 spoon|匙 drink|喝 wash|洗 eat|吃 breakfast|早饭 lunch|午饭 dinner|晚饭 candle|蜡烛 noodle|面条",
"2025-7-23 clothes|衣服 coat|大衣 dress|连衣裙 shirt|衬衫 shorts|短裤 please|使...高兴 wrong|罪恶 new|新的 wear|穿 make|制造",
"2025-7-24 underlined|画线 phrase|词组 can|能够 following|下列 title|标题 teacher|教师 clever|聪明的 easy|容易的 hard|努力的 overcome|克服 police|警察 doctor|医生 farmer|农民 bag|包 cap|帽",
"2025-7-25 cook|厨师 put|放 house|房子 floor|楼房 library|图书馆 bed|床 learn|学习 know|知道 English|英语 way|方式 read|读 word|字 door|门 book|书 let|让",
"2025-7-26 class|班级 classroom|教室 school|学校 lesson|课 book|书 ruler|尺 pen|钢笔 pencil|铅笔 schoolbag|书包 watch|手表 bus|公共汽车 walk|步行 kitchen|厨房 street|街道 garden|果园",
"2025-7-27 cinema|电影院 subject|学科 letter|信 ask|要求 think|认为 way|道路 paper|纸 cold|寒冷的 healthy|健康的 run|跑 bike|自行车 boat|船 car|车 taxi|出租车 highway|高速公路",
"2025-7-31 student|学生 study|学习 busy|忙的 talk|谈话 draw|画 bad|坏的 use|利用 china|中国 computer|计算机 film|电影 hear|听 cry|哭 tell|说 catch|赶上 give|赠送",
"2025-8-1 cool|凉的 jump|跳 move|移动 bring|带来 wait|等待 playground|操场 piano|钢琴 story|小说 show|演出 ill|不健康的",
"2025-8-3 listen|听 sound|声音 speak|说话 write|写 answer|回答 question|问题 trousers|裤子 hurt|受伤 hospital|医院 table|表 nurse|护士 well|健康的 holiday|节日 travel|旅游 fly|飞行",
"2025-8-4 room|房间 sea|海洋 beach|海滩 map|地图 place|地方 visit|参观 hurry|匆忙 buy|购买 shop|商店 sell|出售 gift|礼物 picture|照片 wonderful|极好的 famous|著名的 welcome|欢迎",
"2025-8-5 fast|快的 slow|慢的 stop|车站 park|公园 safe|安全的 free|自由的 city|城市 money|货币 science|科学 internet|因特网 phone|电话 email|电子邮件 robot|机器人 wire|电线 hill|山丘",
"2025-8-6 water|水 river|河 lake|湖 air|空气 weather|天气 sun|太阳 sunny|晴朗的 cloudy|多云的 windy|有风的 rain|雨 ice|冰 warm|温暖的 hot|热的 pet|宠物 animal|动物",
"2025-8-7 cat|猫 dog|狗 bird|鸟 tiger|虎 panda|熊猫 monkey|猴 lion|狮 elephant|象 zoo|动物园 fish|鱼 farm|农场 sleep|羊 rabbit|兔 pig|猪 horse|马",
"2025-8-8 cow|奶牛 duck|鸭 tail|尾巴 plant|种植 flower|花 grass|草 tree|树 field|田 dirty|脏的 clean|打扫 tidy|整理 earth|地球 fire|火;开枪 astronaut|宇航员 space|空间 star|星",
"2025-8-9 noon|中午 a.m|上午 p.m|下午 calender|日历 era|纪元 period|时期 age|时代 century|世纪 week|周 weekend|周末 time|时间 early|早的 late|晚的 later|后来的 hour|时",
"2025-8-11 o'clock|小时 year|年 month|月 yesterday|昨天 tonight|今晚 weekday|工作日 after|在...后 daily|每天 past|过去 future|将来 forever|永远 final|最终 finally|终于 lasting|持久的 moment|瞬间",
"2025-8-12 season|季节 spring|春季 summer|夏季 autumn|秋季 winter|冬季 since|自...以来 soon|不久 while|一会儿 already|已经 recent|近来的 lately|最近 ever|曾经 everyday|每日的 usual|经常 seldom|很少",
"2025-8-13 hardly|几乎不 once|一次 twice|两次 again|再一次 divide|除 division|除法 add|添加 addition|加法 additional|额外的 count|数数 countless|无数的 several|几个 quarter|一刻钟 double|两倍 per|每",
]
</script>
<script>
let wordList = []
function updateWords(text) {
  let ss = []
  wordList = text.split(/[\r\n]+/g).sort(()=>Math.random() - 0.5).map((word, index) => {
    let wordFmt = word.indexOf("$") > 0 ? word.replace(/\$/g, ' ') : word
    let title = wordFmt
    if(wordFmt.indexOf("|") > 0) {
      title = wordFmt.split("|")[1]
      wordFmt = wordFmt.split("|")[0]
    }
    ss.push('<li><a class="word-' + index + '" onclick="play(' + index + ')">' + wordFmt + ' # ' + title + '</a></li>')
    return wordFmt
  })
  words.innerHTML = ss.join("")
  return text
}
function inputWords() {
  let text = input.value
  if(text != word_list_text) {
    updateWords(text)
    word_list_text = text
    localStorage.setItem("word-list-text", text)
  }
}
function selectWords() {
  let item = word_list_data[select.value]
  if(item) {
    let text = item.split(" ").slice(1).join("\r\n")
    input.value = updateWords(text)
  }
}
function playWord(word) {
  let type = document.querySelector("[name=type]:checked").value
  audio.src = '//dict.youdao.com/dictvoice?type=' + type + '&audio=' + word
  audio.play()
}
function play(index) {
  playPause()
  playWord(wordList[index])
}
function playHighlight(index) {
  let curr = words.querySelector("a[selected]")
  if(curr) {
    curr.removeAttribute("selected")
  }
  words.querySelector("a.word-" + index).setAttribute("selected", "selected")
}
let timeID = null
let ended = null
let playing = false
function playPause() {
  playing = false
  btn.innerText = '开始'
  audio.pause()
  audio.removeEventListener("ended", ended)
  ended = null
  if(timeID) {
    clearTimeout(timeID)
  }
}
function playLoop() {
  if(playing) {
    playPause()
  } else if(wordList.length) {
    btn.innerText = '停止'
    playing = true
    let index = 0
    let t = 1
    let s = +count.value
    let d = +delay.value * 1000
    let next = () => {
      index++
      let word = wordList[index]
      if(word) {
        playHighlight(index)
        playWord(word)
      } else {
        playing = false
        audio.removeEventListener("ended", ended)
        ended = null
      }
    }
    ended = () => {
      if(t < s) {
        t++
        timeID = setTimeout(() => { audio.play() }, d)
      } else {
        t = 1
        audio.pause()
        timeID = setTimeout(next, d)
      }
    }
    audio.addEventListener("ended", ended)
    playHighlight(index)
    playWord(wordList[index])
  }
}
let select = document.getElementById("select")
let input = document.getElementById("input")
let words = document.getElementById("words")
let audio = document.getElementById("audio")
let count = document.getElementById("count")
let delay = document.getElementById("delay")
let btn = document.getElementById("btn")

let word_list_text = localStorage.getItem("word-list-text")
if(word_list_text) {
  input.value = updateWords(word_list_text)
}

if(word_list_data) {
  let options = ['<option>---请选择---</option>']
  word_list_data.map((item, index) => {
    let name = item.split(" ")[0]
    options.push('<option value="' + index + '">' + name + '</option>')
  })
  select.innerHTML = options.join("")
}

btn.addEventListener("click", playLoop, false)
input.addEventListener("blur", inputWords, false)
select.addEventListener("change", selectWords, false)
</script>
</body>
</html>